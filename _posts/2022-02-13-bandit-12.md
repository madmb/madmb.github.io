---
title: Bandit-12 ğŸ”¥
published: true
---

## [](#header-1)Login

```bash
sshpass -p 5Te8Y4drgCRfCx8ugdwuEX8KFC6k2EUu \
ssh bandit12@bandit.labs.overthewire.org -p2220
```

## [](#header-1)Level Goal

```
The password for the next level is stored in the file data.txt,
which is a hexdump of a file that has been repeatedly compressed.
For this level it may be useful to create a directory under /tmp
in which you can work using mkdir. For example: mkdir /tmp/myname123.
Then copy the datafile using cp, and rename it using mv (read the manpages!)

Commands you may need to solve this level
grep, sort, uniq, strings, base64, tr, tar, gzip, bzip2, xxd, mkdir, cp, mv, file
```

Tenemos un fichero en hexdump que ha sido comprimido varias veces, la contraseÃ±a
esta en este fichero. Esta vez nos dejan un directorio (/tmp) para crear ficheros.

Primero vamos a pasar el fichero hexdump a binario con el comand xxd

```
bandit12@bandit:/tmp/gorry$ xxd -r data.txt > data.bin
cat data bin
Pï¿½^data2.bin=ï¿½ï¿½BZh91AY&SYï¿½Oï¿½ï¿½ï¿½ï¿½ÚOvï¿½ï¿½ï¿½}?ï¿½ï¿½}ï¿½ï¿½^ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ß£ï¿½ï¿½;ï¿½ï¿½ï¿½ï¿½ï¿½4ï¿½ï¿½ï¿½hï¿½Fï¿½Fï¿½ï¿½4LM
                                                                             @ï¿½ï¿½zï¿½ï¿½FMï¿½ï¿½Cï¿½hFï¿½C@ï¿½4@fï¿½ï¿½h
                                                                                                    ï¿½4hhï¿½ï¿½=C%ï¿½>Xï¿½,ï¿½kï¿½ï¿½ï¿½1ï¿½ï¿½GYï¿½ï¿½
ï¿½Jï¿½ìŒ‘OÏŠï¿½ï¿½{RBpï¿½Qixï¿½Yï¿½Z!dï¿½ï¿½jï¿½(ï¿½æ¿İ³ï¿½ï¿½/ï¿½ï¿½Aï¿½#ï¿½Aï¿½Fï¿½ï¿½0Pï¿½ï¿½vï¿½ï¿½`ï¿½"3ï¿½

                                          ï¿½ï¿½dï¿½bX?ï¿½ï¿½zï¿½ï¿½2ï¿½ï¿½<ï¿½ï¿½A ï¿½n}
5(3Aï¿½ï¿½
      wOï¿½Rï¿½ï¿½ï¿½ï¿½6ï¿½XS{ï¿½
ï¿½ï¿½9?Lï¿½Pï¿½yBï¿½ï¿½=zï¿½m?ï¿½Lï¿½Nt*ï¿½7{qPï¿½ï¿½Ìœï¿½%"ï¿½w9ï¿½qm4ï¿½ï¿½ N3ï¿½6ï¿½ï¿½ï¿½Kï¿½ï¿½Hä‹‘[ï¿½ï¿½}!
                                                             dï¿½ï¿½3A4$ï¿½M~ï¿½\É Jï¿½Cï¿½kUÆ¦\ï¿½ï¿½ï¿½\ï¿½FSNï¿½ï¿½&=ï¿½[ï¿½ï¿½q	\)ï¿½$:ï¿½ï¿½Hï¿½t&/ï¿½(ï¿½ï¿½ï¿½ï¿½]ï¿½ï¿½BB9<s ï¿½ï¿½h=
```

Veamos con el comando file que tipo de binario es.

```
bandit12@bandit:/tmp/gorry$ file -i data.bin
data.bin: application/gzip; charset=binary
```
Vemos que es un archivo comprimido en gzip

```
bandit12@bandit:/tmp/gorry$ mv data.bin data.gz
```

Vemos su contenido

```
bandit12@bandit:/tmp/gorry$ gzip -lv data.gz
method  crc     date  time           compressed        uncompressed  ratio uncompressed_name
defla 1d68f798 Apr 13 15:19                 606                 573  -0.9% data
```

Descomprimimos y veamos que tipo de fichero es

```
bandit12@bandit:/tmp/gorry$ gzip -d data.gz 
bandit12@bandit:/tmp/gorry$ file -i data
data: application/x-bzip2; charset=binary
```

Esta vez en un fichero bzip2

```
mv data data.bz2
bzip2 -d data.bz2
```

De nuevo es un data, esta vez gzip. Hare un script para automatizar

```bash

#!/bin/bash

# Al ver la mecanica que esta llevando, parece ser que siempre hay
# solo un archivo en cada fichero comprimido
# Hare todas las descompresiones en una carpeta llamada test
# Cuando se descomprime en gz o bz2, quedara solo el archivo 
# que estaba comprimido. Con los tar no sucede con lo que 
# tengo que eliminarlo para que solo me quede un 
# un archivo resultante (la variable file) en el directorio test.

while [ True ]; do

        file=$(ls test)

	# Extraemos el tipo de fichero (gzip,bzip,etc)
        if [ -f test/${file} ]; then
                typefile=$(file -i test/${file} | awk -F '/' '{print $3}' | awk -F ';' '{p$
        else
                echo "error comando file -> $file"
                break
        fi

	# dependiendo del tipo de fichero lo renombramos y descomprimimos
        case $typefile in
                'gzip')
                mv test/${file} test/data.gz
                gzip -d test/data.gz
                ;;

                'x-bzip2')
                mv test/${file} test/data.bz2
                bzip2 -d test/data.bz2
                ;;

                'x-tar')
                mv test/${file} test/data.tar
                tar -xf test/data.tar -C test
                rm test/data.tar
                ;;

                *)
                echo "No se pudo descomprimir. Es un $typefile"
                break
                ;;
        esac
done
```

Ejecutamos el script y como resultado

```
bandit12@bandit:/tmp/gorry$ bash bandit12.bash
No se pudo descomprimir. Es un plain

bandit12@bandit:/tmp/gorry$ cat test/data 
The password is 8ZjyCRiBWFYkneahHwxCv3wb2a1ORpYL
```



[Volver al archivo](archive)
